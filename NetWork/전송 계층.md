# 전송 계층
- TCP와 UDP의 특징과 동작 방식
- 포트 번호와 소켓 개념
- 신뢰성, 흐름 제어, 혼잡 제어

## TCP와 UDP의 특징과 동작 방식

### TCP (Transmission Control Protocol)
- 연결형 서비스로, 송신자와 수신자 간에 논리적인 연결을 설정하는 3-way 핸드셰이크 과정을 거친다. <br>
<U>(3-way 핸드셰이크 : 네트워크에서 통신을 시작하기 전에 클라이언트와 서버가 서로 연결 상태를 설정하는 3단계 과정)</U>
- 데이터의 전송 순서를 보장하며, 흐름 제어와 오류 검사, 재전송 제어를 통해 신뢰성 있는 통신을 제공
- 데이터는 바이트 스트림 형태로 전달되며, 네트워크 상태에 따라 전송 속도가 상대적으로 느림
- 신뢰성이 중요한 웹, 파일 전송, 이메일 등에서 사용

### UDP (User Datagram Protocol)
- 비연결형 서비스로, 연결 설정 과정이 없고 각각의 데이터그램이 독립적으로 처리
- 데이터 전송 순서 보장 및 재전송을 하지 않고, 수신 여부 확인 절차가 없기 때문에 신뢰성이 낮음
- 헤더가 단순하고 오버헤드가 적어 TCP보다 빠른 전송 속도를 제공하며, 네트워크 부하가 적음
- 실시간 음성, 영상 스트리밍, 온라인 게임처럼 빠른 전송과 연속성이 중요한 서비스에서 사용

### 동작 방식 비교
- TCP는 데이터를 보내기 전에 수신자와 연결을 설정하고, 데이터를 안전하게 전달하기 위해 확인 응답과 재전송을 수행
- UDP는 연결 과정 없이 데이터를 보내며, 데이터가 손실되거나 순서가 바뀌어도 복구하지 않는다. 때문에 속도는 빠르지만 신뢰성은 낮음

## 포트 번호와 소켓 개념

### 포트 번호
- 같은 컴퓨터 내에서 여러 애플리케이션이 동시에 네트워크 통신을 할 때 서로의 데이터를 구별하고 배분하기 위해 사용
- 포트 번호는 여러 애플리케이션 간의 통신 경로를 분리해주는 출입구 번호
- 포트 번호는 16비트 숫자로 표현되어 0부터 65535까지 있음
    - 0~1023은 잘 알려진 포트 (ex- 80번 HTTP/21번 FTP/22번 SSH/25번 SMTP 등)
    - 1024~49151은 등록된 포트
    - 49152~65535는 동적 또는 임시 포트

### 소켓
- IP 주소와 포트 번호의 조합으로 표현되며, 네트워크에서 소켓은 통신의 끝점을 의미
- 한 소켓은 하나의 IP 주소와 하나의 포트 번호를 포함하여 네트워크 상에서 특정 프로세스 간의 통신 경로를 지정
- 클라이언트와 서버는 각각 소켓을 통해 연결을 맺고 데이터를 주고받는다

## 신뢰성, 흐름 제어, 혼잡 제어

### 신뢰성
- 전송 계층은 데이터가 정확하게 목적지에 도착하도록 보장
- TCP는 연결형 통신으로, 데이터가 손실되거나 손상되었을 때 재전송을 통해 복구
- 송신자는 수신자의 확인 응답(ACK)을 받고 재전송 여부를 결정하며, 순서 제어로 데이터를 올바르게 재조립
- 체크섬으로 데이터 무결성을 검사하며, 오류가 발견되면 재전송을 요청

### 흐름 제어
- 수신자가 처리 가능한 속도보다 송신 속도가 빠르면 수신측 버퍼가 넘치게 되어 데이터 손실이 발생할 수 있음 
- 이를 방지하기 위해 TCP는 슬라이딩 윈도우 방식을 사용해 송신자가 한 번에 보낼 수 있는 데이터 양을 조절
- 수신자는 윈도우 크기 정보를 주기적으로 송신자에게 알려주어 적절한 데이터 흐름을 유지

### 혼잡 제어
- 네트워크 전체상의 트래픽이 많아지면 패킷 손실과 지연이 발생하므로, 네트워크 혼잡을 감지하고 이를 완화하는 기능
- TCP는 혼잡 윈도우(Congestion Window)를 조절하면서 네트워크 상황에 따라 전송률을 동적으로 조절
- 대표적인 기법으로는 Slow Start, Congestion Avoidance, Fast Retransmit 등이 있어 네트워크 과부하를 예방하고 안정적인 통신을 지원 
    - Slow Start : TCP 연결 초기 또는 타임아웃 발생 후, 혼잡 상태를 모르는 상황에서 송신 윈도우 크기(cwnd)를 1 MSS부터 시작해 패킷이 성공적으로 도착할 때마다 윈도우 크기를 지수적으로(2배씩) 증가
    - Congestion Avoidance : Slow Start 임계점 도달 후부터 적용되는 기법으로, 윈도우 크기를 지수적이 아닌 선형적으로(즉 한 번 RTT마다 1 MSS씩) 증가시켜 네트워크 혼잡을 방지하며 전송 속도를 서서히 높임
    - Fast Retransmit : TCP 송신자는 동일한 ACK가 3번 연속으로 도착하는 경우(중복 ACK 3회)를 혼잡 또는 패킷 손실의 신호로 간주하고, 타임아웃을 기다리지 않고 즉시 손실된 패킷을 재전송

## 장비 소개
1. L4 스위치(L4 Switch)
- 전송 계층(4계층)에서 동작하는 장비로, IP 주소뿐 아니라 TCP/UDP 포트 번호를 기준으로 트래픽을 분류하고 제어
- 애플리케이션별, 서비스별로 트래픽 우선순위를 지정하거나 로드 밸런싱(부하 분산)을 수행할 수 있음

2. 방화벽(Firewall)
- 네트워크 계층(3계층)과 전송 계층(4계층)에서 동작하며 IP 주소, 포트 번호, 프로토콜 등을 기준으로 트래픽을 필터링 및 제어

3. 로드 밸런서(Load Balancer)
- 주로 4계층(L4 로드 밸런서)에서 IP와 포트 정보를 기반으로 트래픽 분산을 수행