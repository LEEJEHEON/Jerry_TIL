# 네트워크 계층
- IP 주소 체계 (IPv4, IPv6)
- 서브넷팅과 슈퍼넷팅
- 라우팅 개념과 프로토콜 (RIP, OSPF, BGP)
- NAT, ICMP 이해

## IP 주소 체계 (IPv4, IPv6)
- 네트워크에서 각 장치(컴퓨터, 서버 등)가 고유하게 식별될 수 있도록 하는 주소 구조

### IPv4
- IPv4는 32비트(4바이트)로 구성되어 있으며, 8비트씩 4개로 나누어진 10진수로 표기
- 각 부분(옥텟)은 0~255 사이의 값으로, 점(dot)으로 구분
- 전체 주소 공간은 약 43억(2³²)개로 한정되어 있어, 인터넷 장치의 급증으로 인해 주소 고갈 문제가 발생함
- IPv4는 네트워크 부분(Net ID)과 호스트 부분(Host ID)으로 나뉘며, 네트워크에서 각 장치를 구분하는 용도로 사용
- 초기에 A/B/C/D/E 클래스 방식으로 네트워크 크기와 용도별로 구분했으며, 이후엔 유연한 서브넷 마스크와 CIDR 표기법 방식으로 발전  
(서브넷 마스크 : 로컬 네트워크 내부에서 접속한 호스트의 IP 대역을 외부 네트워크와 명확하게 구분할 수 있는 수단을 표준화)  
(CIDR 표기법 : IP 주소 블록을 나타내는 표준 방식으로, IP 주소 뒤에 슬래시(/)와 숫자를 붙여 네트워크의 범위를 나타냄)

### IPv6
- 주소 공간 부족 문제를 해결하기 위해 고안된 128비트(16바이트) 주소 체계
- 16비트씩 8개로 구분하여, 각 부분은 4자리 16진수로 작성하고 콜론(:)으로 구분
- IPv6는 2¹²⁸개의 주소를 가질 수 있어, 사실상 무한대에 가까운 수의 장치에 고유 주소 부여가 가능
- 주소 자동 설정, 단순화된 헤더 구조, 보안(IPSec 기본 제공), QoS 등 다양한 기능이 추가되어, 현대 인터넷 환경에 최적화된 구조를 제공
- IPv6 주소는 앞부분 64비트는 네트워크 ID, 뒷부분 64비트는 인터페이스 ID로 구성

## 서브넷팅과 슈퍼넷팅
- IP 주소 공간을 효율적으로 관리하기 위한 기법
- 각각 네트워크를 쪼개고, 통합하는 특징이 있음
- 서브넷팅은 자원을 효율적으로 분할, 슈퍼넷팅은 통합과 집계에 사용되며, 현대 IP 네트워크의 실질적인 주소 관리는 주로 클래스 없는(CIDR) 방식에서 두 기법이 모두 적극적으로 쓰임 

### 서브넷팅 (Subnetting)
- 하나의 큰 네트워크 주소 공간(예: 클래스 A/B/C 대역)을 여러 개의 작은 네트워크(서브넷)로 나누는 과정
- 동작 방식: IP 주소의 호스트 부분 일부를 빌려와 서브넷 ID로 사용하여 여러 개의 논리적 네트워크로 분할
- 장점 :
    - 필요한 만큼 네트워크를 잘게 나눠 IP 자원을 효율적으로 활용 가능
    - 보안, 네트워크 트래픽 분산, 충돌 도메인 분할 등 네트워크 관리가 유리
- 단점 : 
    - 네트워크가 수용가능한 인원이 넘도록 확장하게 되면 네트워크를 다시 구성 필요 
    - 하나의 네트워크 당 네트워크 대표주소, 브로드캐스트주소는 반드시 있어야 하므로 너무 많이 쪼개면 오히려 효율이 역으로 떨어짐 
- 예시: 192.168.10.0/24를 4개의 서브넷(192.168.10.0/26, 192.168.10.64/26 등)으로 나눔


### 슈퍼넷팅 (Supernetting)
- 여러 개의 작은 네트워크(서브넷, 혹은 개별 네트워크)를 하나의 큰 네트워크(슈퍼넷)로 통합하는 과정
- 동작 방식: IP 주소의 네트워크 부분의 일부 비트를 호스트 ID로 전환하여, 인접한 여러 네트워크를 한 데 묶어 라우팅 테이블을 간소화
- 장점 : 
    - 라우터에서 관리해야 할 라우팅 테이블의 엔트리 수를 감소시켜 효율성과 성능이 향상
    - 인터넷 대규모 네트워크 및 서비스 제공자(ISP) 환경에서 주소 할당과 트래픽 관리 효율 극대화
- 단점 :
    - 전체 네트워크 구성을 미리 알고 확장을 해야한다.(다른 대역과 충돌이 발생하면 안되기에)
- 예시: 192.168.0.0/24와 192.168.1.0/24 두 서브넷을 묶어 192.168.0.0/23 한 개로 통합함.

## 라우팅 개념과 프로토콜 (RIP, OSPF, BGP)
- 네트워크 계층에서 데이터 패킷이 목적지까지 도달할 수 있도록 최적의 경로를 결정하는 과정
- 이를 위해 라우터는 라우팅 테이블을 사용하고, 라우팅 프로토콜은 이러한 경로 정보를 자동으로 교환·갱신하는 역할

### 라우팅
- 네트워크 내부 또는 여러 네트워크 사이에서 데이터가 <b>목적지까지 이동할 경로를 결정</b>하는 네트워크 계층의 핵심 기능
- 데이터 패킷은 라우터를 거치며, 각 라우터는 자신의 라우팅 테이블을 참조해 다음 홉(Next Hop)으로 전송
    - 정적 라우팅 (Static) : 관리자가 수동으로 경로 정보를 입력,관리함
    - 동적 라우팅 (Dynamic) : 라우팅 프로토콜을 통해 자동으로 경로 정보를 교환, 업데이트함. 

### RIP (Routing Information Protocol)
- 거리 벡터 방식의 라우팅 프로토콜로, 홉 수(중간 경유 라우터 수)를 기준으로 경로를 선택
- 최대 홉 수가 15로 제한되어 있어 소규모 네트워크에 적합
- 라우터가 주기적으로 라우팅 정보를 브로드캐스트하여 공유
- 단순하지만 경로 변화에 느리게 반응해 라우팅 루프 발생 가능성이 있음

### OSPF (Open Shortest Path First)
- 링크 상태 방식의 내부 게이트웨이 프로토콜(IGP)로, 각 라우터가 전체 네트워크의 토폴로지를 파악하고 최단 경로를 계산
- 다익스트라 알고리즘을 사용하여 효율적인 경로를 찾음
- 대규모 엔터프라이즈 네트워크에 적합하며, 경로 계산이 빠르게 이루어짐
- 계층적 네트워크 구성 지원으로 확장성이 좋음

### BGP (Border Gateway Protocol)
- 경로 벡터 방식의 외부 게이트웨이 프로토콜(EGP)으로, 자율 시스템(AS) 간의 경로 정보를 교환
- 인터넷의 주된 라우팅 프로토콜로, 복잡한 정책 기반 라우팅과 경로 필터링을 지원
- 경로 안정성, 로드 밸런싱, 정책 제어 기능이 뛰어나며 대규모 네트워크에 적합

## NAT, ICMP 이해

### NAT (Network Address Translation)
- NAT는 네트워크에서 IP 패킷의 출발지 또는 목적지 IP 주소를 바꾸어 재기록하는 기술
    - 주로 사설 IP 주소를 공인 IP 주소로 변환하여 여러 기기가 하나의 공인 IP 주소로 인터넷에 접속
- 주요 목적은 IPv4 주소 부족 문제 해결과 내부 네트워크 보안 강화
    - NAT를 사용하면 공인 IP 주소를 절약할 수 있고, 내부 사설 IP를 외부에 숨겨 공격으로부터 보호할 수 있다
- NAT 동작 시 IP 주소뿐 아니라 TCP/UDP 포트 번호도 변환하여 여러 내부 기기가 동시에 외부와 통신할 수 있도록 함  
(포트 주소 변환(PAT))
- NAT 유형에는 각각 동작 방식과 보안 특성에 따라 Full-Cone, Restricted Cone, Symmetric NAT 등이 있음

### ICMP (Internet Control Message Protocol)
- ICMP는 인터넷 프로토콜(IP) 네트워크에서 오류 메시지와 운용 정보를 전달하는 프로토콜
- 주로 네트워크 장애 진단, 상태 확인 등에 사용 
    - 예를 들어, ping 명령어는 ICMP Echo Request와 Echo Reply 메시지를 이용해 호스트 간 연결 상태를 점검
- ICMP 메시지는 IP 패킷 내부에 포함되어 전송되며, 패킷이 도달하지 못했거나 네트워크 문제 발생 시 해당 정보를 송신자에게 알려줌
- ICMP는 라우터가 경로의 문제를 인지하고 관리자에게 알리는 데 중요한 역할을 함
- 다만, ICMP는 데이터 전달 프로토콜이라기보다 제어 메시지용 프로토콜