# 트랜잭션

## 💡트랜잭션이란,
- DBMS에서 데이터를 다루는 논리적인 작업의 단위
> 트랜잭션을 정의하는 이유
>> 1. 데이터를 다룰 때 장애가 일어나면, 트랜잭션은 장애 시 데이터를 복구하는 작업의 단위가 됨
>> 2. DB에서 여러 작업이 동시에 같은 데이터를 다룰 때, 트랜잭션은 이 작업을 서로 분리하는 단위가 됨 

## 💡트랜잭션의 성질 (ACID 원칙)
- ACID 원칙은 데이터베이스 시스템의 무결성, 신뢰성, 안정성을 확보하는데 매우 중요한 역할

1. Atomicity (원자성)
- 트랜잭션 내 여러 작업이 모두 수행되거나 전혀 수행되지 않아야 한다는 성질 (ALL or nothing)
- 부분 완료가 불가능하며, 오류 발생 시 전체 트랜잭션이 무효화
(SAVEPOINT : 에러가 발생하면 트랜잭션 전체가 ROLLBACK이 아니라 SAVEPOINT로 되돌아간다.)
  
2. Consistency (일관성)
- 트랜잭션이 실행되기 전과 후에 데이터베이스의 규칙, 제약조건이 항상 맞아떨어져야 한다는 성질
- 트랜잭션 실행 전후에 항상 데이터의 무결성이 보장되어야 한다.
  
3. Isolation (고립성)
- 동시에 여러 트랜잭션이 실행되어도 각각의 트랜잭션이 서로 간섭받지 않아야 한다는 성질
- 고립성을 유지하기 위해서는 변경중인 임시 데이터를 다른 트랜잭션이 읽거나 쓰려고 할 때 제어하는 작업이 필요
  
4. Durability (지속성)
- 트랜잭션이 성공적으로 완료(커밋)되면, 해당 결과는 DB에 영구적으로 반영되어야 한다는 성질
- 예기치 못한 시스템 장애나 오류가 발생해도 트랜잭션의 결과는 보존
  
## 💡동시성 제어
- 다수의 트랜잭션이 동시에 데이터베이스에 접근할 때 데이터의 일관성, 무결성을 유지하고 성능을 보장하기 위한 핵심 기법

※ 트랜잭션의 읽기 / 쓰기 시나리오오
| 상황   | 트랜잭션1 | 트랜잭션2 | 발생 문제 | 동시 접근 |
|-----------|-------|--------|-----------|-----------|
| 상황 1    | 읽기  | 읽기 | 없음         | 허용         |
| 상황 2    | 읽기  | 쓰기 | 오손 읽기, 반복불가능 읽기, 유령데이터 읽기 | 허용 혹은 불가 선택 |
| 상황 3    | 쓰기  | 쓰기 | 갱신손실       | 허용불가(LOCK을 이용) |

### 갱신손실
- 2개의 트랜잭션이 1개의 데이터를 동시에 갱신할 때 발생 (절대 발생하면 안되는 현상)

### 동시성 제어의 주요 목적
- 트랜잭션 간 상호 간섭 최소화
- 데이터 일관성 및 무결성 유지
- 시스템 성능 (처리량, 응답시간) 극대화
- 직렬화 (Serializability) 보장 : 결과가 마치 트랜잭션을 순차적으로 수행한 것과 동일해야 함


## 💡트랜잭션 고립 수준

## 💡회복


## 💡트랜잭션 격리 레벨


3. 트랜잭션이 무엇이고, ACID 원칙에 대해 설명해 주세요.
• ACID 원칙 중, Durability를 DBMS는 어떻게 보장하나요?
• 트랜잭션을 사용해 본 경험이 있나요? 어떤 경우에 사용할 수 있나요?
• 읽기에는 트랜잭션을 걸지 않아도 될까요?

4. 트랜잭션 격리 레벨에 대해 설명해 주세요.
• 모든 DBMS가 4개의 레벨을 모두 구현하고 있나요? 그렇지 않다면 그 이유는 무엇일까요?
• 만약 MySQL을 사용하고 있다면, (InnoDB 기준) Undo 영역과 Redo 영역에 대해 설명해 주세요.
• 그런데, 스토리지 엔진이 정확히 무엇을 하는 건가요?