# DB Connection
- DB의 Connection은 클라이언트(애플리케이션)와 데이터베이스 서버 간의 물리적 또는 논리적인 연결 통로
- DB 서버와 통신하기 위해 열려 있는 네트워크 세션

## 💡 DB Connection 정의 및 특징
- 클라이언트가 DB 서버에 연결 요청 시 TCP/IP 등 네트워크 채널이 형성되어 통신할 수 있는 "통로"가 만들어짐
- 이 통로를 통해 SQL 쿼리, 데이터 송수신 등이 이루어짐
- 각 Connection은 DB 서버의 메모리, CPU, 스레드 자원을 소모
- Connection이 많아지면 DB 서버 부하가 증가하므로 적절한 관리가 필요

## 💡 Connection과 Session의 차이 
- Connection: DB와 클라이언트 간의 물리적 연결.
- Session: 연결을 통해 이루어지는 논리적 상호작용 상태(트랜잭션 상태, 인증 정보 등)를 의미.
- 보통 1개의 Connection은 1개의 Session을 가짐. (여러개도 가능)

## 💡 동작 예시
- 애플리케이션이 JDBC 등의 드라이버를 이용해 DB에 연결 객체(Connection)를 생성
- 생성된 Connection 객체로 SQL 실행, 트랜잭션 처리 등을 수행
- 작업이 끝나면 Connection을 닫아 자원을 반납

## 💡Connection pool 
- 미리 여러 개의 데이터베이스 연결(Connection) 객체를 만들어두고, 클라이언트 요청이 있을 때 풀에서 연결을 빌려 써서 작업 후 다시 반환하는 기술

### 주요 개념
 - DB 연결은 생성하는 데 비용과 시간이 많이 드는 복잡한 작업(네트워크 연결, 인증 등)이 필요
 - 커넥션 풀은 서버가 시작할 때 일정량의 연결을 미리 만들어서 저장
 - 클라이언트 요청 시 이 저장된 연결을 즉시 제공해 빠른 응답이 가능하도록 함
 - 작업이 끝나면 연결을 닫지 않고 다시 풀에 반납
 - 필요한 경우 풀 크기 내에서 새 연결을 추가 생성

### 장점
 - 연결 생성 및 종료 비용 감소로 애플리케이션 성능 향상
 - 데이터베이스 서버 과부하 방지 및 안정적인 연결 관리
 - 응답 지연 시간 감소

### 동작 과정
1. 애플리케이션 서버(WAS)가 시작되면 미리 커넥션을 생성하여 풀에 저장
2. 클라이언트 요청 발생 시 풀에서 커넥션 할당
3. 작업 완료 후 커넥션을 풀에 반환
4. 커넥션이 모두 사용 중이면 대기하거나, 최대 크기 미달 시 새로 생성

## ❓ QnA

### 🙋‍♂️ DB와 Client가 Connection을 어떻게 구성하는지 설명해 주세요.
💁
1. 클라이언트-서버 모델 기반 연결
    - 클라이언트는 애플리케이션 서버(WAS, DB 클라이언트 툴 등)에서 동작하며, DB 서버에 접속하기 위해 연결(Connection) 요청을 보냄
    - DB 서버는 클라이언트의 연결 요청을 받아 내부에 세션(Session)을 생성하여 클라이언트와의 통신을 관리
    - 클라이언트는 이 연결을 통해 SQL 쿼리를 전송하고, DB 서버는 쿼리를 처리한 결과를 클라이언트에 반환
2. 연결 과정
    - 클라이언트는 DB 벤더에 맞는 드라이버를 로드하고, DriverManager.getConnection() 등의 메서드로 연결을 생성
    - 연결 생성 시 네트워크 연결이 설정되고 인증이 이루어짐
    - 연결이 만들어지면 애플리케이션은 Connection 객체를 통해 DB와 상호작용할 수 있음
3. 연결과 세션 
    - 실제로 연결(Connection)은 클라이언트와 DB 서버 간 네트워크상의 통로, 
    - 세션(Session)은 DB 서버가 연결을 통해 관리하는 상태 단위로, 트랜잭션 수행과 같은 논리적 작업 단위를 의미
    - 하나의 연결마다 하나의 세션이 존재하며, 세션은 트랜잭션 시작, 커밋, 롤백 등을 담당
4. 커넥션 풀 사용 이유 
    - 매번 DB 연결을 새로 생성하면 비용이 많이 들고 성능 저하가 발생하기 때문에, Connection Pool을 통해 미리 여러 연결을 만들어 재사용
  <br><br> 
> 이 연결(Connection)과 세션(Session)을 효율적으로 관리하는 것이 데이터베이스 운영의 핵심이 연결(Connection)과 세션(Session)을 효율적으로 관리하는 것이 데이터베이스 운영의 핵심

